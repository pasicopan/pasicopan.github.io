<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>an-idea-about-build-vue-without-webpack | pasico 的idea</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一些想法，服务器编译vue 项目的最低消耗前提 需要生成vue 项目，有Babel ,css scoped style 特性 平台项目相对稳定，开放给第三方开发插件 平台作为编辑器，组合各个插件生成一个vue 项目，但避免每次生成都需要(webpack)编译  描述 有这么一个后台编辑器，通过拖拽把banner，信息流，tabbar 等插件拉到同一个界面，然后可以导出网页 现在，banner ，信">
<meta property="og:type" content="article">
<meta property="og:title" content="an-idea-about-build-vue-without-webpack">
<meta property="og:url" content="http://paisco.cn/2018/07/12/an-idea-about-build-vue-without-webpack.html">
<meta property="og:site_name" content="pasico 的idea">
<meta property="og:description" content="一些想法，服务器编译vue 项目的最低消耗前提 需要生成vue 项目，有Babel ,css scoped style 特性 平台项目相对稳定，开放给第三方开发插件 平台作为编辑器，组合各个插件生成一个vue 项目，但避免每次生成都需要(webpack)编译  描述 有这么一个后台编辑器，通过拖拽把banner，信息流，tabbar 等插件拉到同一个界面，然后可以导出网页 现在，banner ，信">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-05-08T01:20:05.906Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="an-idea-about-build-vue-without-webpack">
<meta name="twitter:description" content="一些想法，服务器编译vue 项目的最低消耗前提 需要生成vue 项目，有Babel ,css scoped style 特性 平台项目相对稳定，开放给第三方开发插件 平台作为编辑器，组合各个插件生成一个vue 项目，但避免每次生成都需要(webpack)编译  描述 有这么一个后台编辑器，通过拖拽把banner，信息流，tabbar 等插件拉到同一个界面，然后可以导出网页 现在，banner ，信">
  
    <link rel="alternate" href="/atom.xml" title="pasico 的idea" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>


  <body>
    <div id="container">
      <div id="wrap">
        <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">pasico 的idea</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://paisco.cn"></form>
      </div>
    </div>
  </div>
</header>
          <div class="outer">
            <section id="main">
              <article id="post-an-idea-about-build-vue-without-webpack" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/12/an-idea-about-build-vue-without-webpack.html" class="article-date">
  <time datetime="2018-07-12T07:42:10.000Z" itemprop="datePublished">2018-07-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      an-idea-about-build-vue-without-webpack
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一些想法，服务器编译vue-项目的最低消耗"><a href="#一些想法，服务器编译vue-项目的最低消耗" class="headerlink" title="一些想法，服务器编译vue 项目的最低消耗"></a>一些想法，服务器编译vue 项目的最低消耗</h2><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><ul>
<li>需要生成vue 项目，有Babel ,css scoped style 特性</li>
<li>平台项目相对稳定，开放给第三方开发插件</li>
<li>平台作为编辑器，组合各个插件生成一个vue 项目，但避免每次生成都需要(webpack)编译</li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><ul>
<li>有这么一个后台编辑器，通过拖拽把banner，信息流，tabbar 等插件拉到同一个界面，然后可以导出网页</li>
<li>现在，banner ，信息流，tabbar 这些组件交给第三方去开发</li>
<li>组合出来的网页，不会使用webpack 进行再次编译</li>
</ul>
<h3 id="想法一-修改本地webpack-编译vue-文件，导出js-文件，上传给平台使用"><a href="#想法一-修改本地webpack-编译vue-文件，导出js-文件，上传给平台使用" class="headerlink" title="想法一 修改本地webpack 编译vue 文件，导出js 文件，上传给平台使用"></a>想法一 修改本地webpack 编译vue 文件，导出js 文件，上传给平台使用</h3><p>参考webpack 的打包方案，如果可以把每个vue （插件）文件都打包成一个chunk，上传给平台，那么平台指需要重写“路由”，“引用”和“文件” 三个地方的 chunk id，其他功能就可以沿用下来，绕开了编译过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以下例子全部基于vue cli 3.0 初始化的demo 项目</span><br></pre></td></tr></table></figure>
<h4 id="首先，获取插件chunk-的文件名"><a href="#首先，获取插件chunk-的文件名" class="headerlink" title="首先，获取插件chunk 的文件名"></a>首先，获取插件chunk 的文件名</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以通过设置webpackChunkName </span></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="comment">// import App from('./App.vue') 替换为 const App = () =&gt; import (/* webpackChunkName: 'App' */'./App.vue')</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// build 出来的chunk 文件将会从0.b0781257.js 替换为App.b0781257.js</span></span><br><span class="line"><span class="comment">// dist/js/</span></span><br><span class="line"><span class="comment">//         - 0.b0781257.js</span></span><br><span class="line"><span class="comment">//         + App.b0781257.js</span></span><br></pre></td></tr></table></figure>
<h4 id="有了文件名，就要开始重写路由"><a href="#有了文件名，就要开始重写路由" class="headerlink" title="有了文件名，就要开始重写路由"></a>有了文件名，就要开始重写路由</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分析app.xxx.js 文件，路由包含&#123; 0: "App", 2: "HelloWorld" &#125; 和&#123; 0: "b0781257", 2: "d6560d55" &#125; </span></span><br><span class="line">这里<span class="number">0</span> 对应App，<span class="number">2</span> 对应HelloWorld，那么路由就能以这种格式，自己任意拓展了</span><br><span class="line">c.charset = <span class="string">"utf-8"</span>, </span><br><span class="line">c.timeout = <span class="number">120</span>, </span><br><span class="line">i.nc &amp;&amp; c.setAttribute(<span class="string">"nonce"</span>, i.nc), </span><br><span class="line">c.src = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; </span><br><span class="line">  <span class="keyword">return</span> i.p + <span class="string">"js/"</span> + (&#123; <span class="number">0</span>: <span class="string">"App"</span>, <span class="number">2</span>: <span class="string">"HelloWorld"</span> &#125;[e] || e) + <span class="string">"."</span> + &#123; <span class="number">0</span>: <span class="string">"b0781257"</span>, <span class="number">2</span>: <span class="string">"d6560d55"</span> &#125;[e] + <span class="string">".js"</span> &#125;(e), </span><br><span class="line">  u = <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br></pre></td></tr></table></figure>
<h4 id="接下来是组件内的引用"><a href="#接下来是组件内的引用" class="headerlink" title="接下来是组件内的引用"></a>接下来是组件内的引用</h4><p>例如这里引用了module id=0 的模块，并绑定了传入了Pf3K 参数<br>Pf3K 对应的是App.xxx.js 这个chunk 里面的一个初始化vue 模板的方法<br>我们处理上传的插件的时候，需要把module id 转换成有效的module id，也就是平台上已经稳定的module id<br>我们可以通过修改webpack output filename 的设置，例如上面打包出来的App.xx.js 模块，加入module id 的信息，变成App.0.xx.js，这样子就可以得到一个映射</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js (编译钱对应main.js)</span></span><br><span class="line"><span class="keyword">var</span> n = r(<span class="string">"Kw5r"</span>),</span><br><span class="line">o = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="keyword">return</span> r.e(<span class="number">0</span>).then(r.bind(<span class="literal">null</span>, <span class="string">"Pf3K"</span>)) <span class="comment">// 引用了App.vue 模块，也就是引用了App.0.xx.js 这个文件</span></span><br><span class="line">  &#125;;</span><br><span class="line">n.a.config.productionTip = !<span class="number">1</span>, <span class="keyword">new</span> n.a(&#123; <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; <span class="keyword">return</span> e(o) &#125; &#125;).$mount(<span class="string">"#app"</span>)</span><br></pre></td></tr></table></figure>
<p>根据以上的映射，我们扫描插件代码，替换成平台的module id和bind 参数就可以了</p>
<pre><code class="javascript"><span class="comment">// App.0.xx.js</span>
<span class="comment">// 同理，每个模块的头部有个push，记录了自身引用的module id 数组，把这里也扫描替换掉</span>
(<span class="built_in">window</span>.webpackJsonp = <span class="built_in">window</span>.webpackJsonp || []).push([[<span class="number">0</span>]

</code></pre>
<h3 id="想法二-本地Babel-编译vue-文件的js-部分，自己写css-scoped-style"><a href="#想法二-本地Babel-编译vue-文件的js-部分，自己写css-scoped-style" class="headerlink" title="想法二 本地Babel 编译vue 文件的js 部分，自己写css scoped style"></a>想法二 本地Babel 编译vue 文件的js 部分，自己写css scoped style</h3><p>待续。。。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://github.com/mrdulin/blog/issues/43" target="_blank" rel="noopener">https://github.com/mrdulin/blog/issues/43</a></li>
<li><a href="https://github.com/hawx1993/tech-blog/issues/3" target="_blank" rel="noopener">https://github.com/hawx1993/tech-blog/issues/3</a></li>
<li><a href="https://webpack.docschina.org/api/module-methods#import-" target="_blank" rel="noopener">https://webpack.docschina.org/api/module-methods#import-</a> </li>
<li><a href="https://github.com/879479119/879479119.github.io/issues/1" target="_blank" rel="noopener">https://github.com/879479119/879479119.github.io/issues/1</a></li>
</ul>

      
      <h3>原创文章，转载必须声明出处!</h3>
    </div>
    <footer class="article-footer">
      <a data-url="http://paisco.cn/2018/07/12/an-idea-about-build-vue-without-webpack.html" data-id="cjwkal10f0009f4ui68sjnr9f" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/08/15/miniprogram-swiper-effect.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          微信小程序 swiper 效果
        
      </div>
    </a>
  
  
    <a href="/2018/07/11/hello-world.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


            </section>
            
              <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/mistake/">mistake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quill/">quill</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/业务思考/">业务思考</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法-优化/">算法 优化</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/mistake/" style="font-size: 10px;">mistake</a> <a href="/tags/quill/" style="font-size: 10px;">quill</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/业务思考/" style="font-size: 10px;">业务思考</a> <a href="/tags/小程序/" style="font-size: 20px;">小程序</a> <a href="/tags/算法-优化/" style="font-size: 10px;">算法 优化</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/06/06/SLS.html">SLS-渐进增强微信小程序组件通讯能力</a>
          </li>
        
          <li>
            <a href="/2019/06/06/AudioManager.html">微信小程序 AudioManager</a>
          </li>
        
          <li>
            <a href="/2019/05/08/miniprogram-richtext.html">小程序富文本处理</a>
          </li>
        
          <li>
            <a href="/2019/02/18/compress-scroll-data.html">压缩页面滚动坐标的数据</a>
          </li>
        
          <li>
            <a href="/2018/12/28/react-quill-image-uploader.html">react-quill-image-uploader</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
                
          </div>
          <footer id="footer">
  
        <div class="outer">
          <div id="footer-info" class="inner">
            &copy;
            2019
              pasico
                <br> mail:
                <a href="mailto:pasico@163.com" title="pasico@163.com">pasico@163.com</a>
                  <br>
                  Powered by
                    <a href="http://hexo.io/" target="_blank">Hexo</a>
          </div>
        </div>
          <script src="https://s19.cnzz.com/z_stat.php?id=1271870936&web_id=1271870936" language="JavaScript"></script>
            </span>
</footer>
      </div>
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
        

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



    </div>
  </body>

  </html>